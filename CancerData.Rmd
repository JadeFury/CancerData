---
title: "CancerData"
author: "Minhaz Khan, Truman Zheng, Navin Chandradat, Vincent La, Bobak Ahmar"
date: "11/13/2018"
output: pdf_document
---

## Group number 7
## Members:
Minhaz Khan,
Bobak Ahmar,
Vincent La,
Navin Chandradat,
Truman Zheng

## Tasks:
data cleaning, summary of data, introduction - Truman

Organizing presentation/presenting - Truman, Minhaz, Vincent

Anaylizing data/performing various test - Everyone 
(idea: each of us analize different variables)

Putting everything together/conclusions - Navin, Bobak


## Introduction
Breast cancer is a malignant cell growth in the breast. If it is left untreated the cancer can spread to other parts of the human body and it can be very deadly. There are generally two type of tumors non-cancerous and cancerous and the difference between the two is important, Benign tumor is non-cancerous and not dangerous on its own, but a malignant tumor, means the mass is cancerous.


## summary of the data
```{r}
library(tidyverse)
```

```{r}
# preview of the data
cancer = read_csv("Project3-Data.csv")
cancer
```
```{r}
# number of variables we have
num_var = ncol(cancer) - 1
num_var
# number of observation we have
num_obs = nrow(cancer)
num_obs
```

```{r}
# the number of each type of tumor
table(cancer$diagnosis)
```

```{r}
# small summary of a few variables
summary(cancer$radius_mean)

summary(cancer$texture_mean)

summary(cancer$perimeter_mean)

summary(cancer$perimeter_mean)
```

##Correlation matrix to observe multicollinearity 
```{r}
library(caret)
library(tidyverse)
library(rlist)
filcancer=cancer[-1:-2]
corcer=cor(filcancer)
fcor = findCorrelation(corcer, cutoff=0.9)
fcor = sort(fcor)
(reduced_Cancer = filcancer[,-c(fcor)])

model = stack(reduced_Cancer)
analysis_of_variance = aov(values~ind, model)
(tukey = TukeyHSD(analysis_of_variance, ordered=TRUE, conf.level=0.95))
#This is a list of all the pvalues and the corresponding pairs.
#tukeypvalues = tukey$ind[,"p adj"]
#Here is my attempt at getting all the ones with p value less than 0.05. Plz send help

result <- data.frame(tukey$ind) %>% filter(.,p.adj<0.05)
result
#(collinearity_list = list())
#for (i in 1:190) {
  #if (tukeypvalues[i] < 0.05){
  #print(i)
  #test %>% append(collinearity_list,tukeypvalues[i])}
#}
```



## logistic regression
```{r}
# taking only the means as a test
can = cancer[2:12]
can

# changing diagnosis from chr to factor
can$diagnosis = as.factor(can$diagnosis)

# fitting the generalized linear model, fam = binomial is so that we are doing a logistic regression
glm.fit = glm(diagnosis ~ texture_mean + area_mean + smoothness_mean + compactness_mean + concavity_mean + symmetry_mean + fractal_dimension_mean + radius_mean + perimeter_mean + concave_points_mean, data=can, family=binomial)

summary(glm.fit)
```
theres various information in the summary but look at the coefficients, we have estimate, SE, z-score, and p-value, the p-value that is less than 0.05 indicates significance, that is those variable has an impact on either cancer being M or B (acording to this site im reading at least)
example: for a unit increase in texture mean the log odd of cancer being M (vs B) increases by 0.38473


## Discriminant Analysis
First we have to compute a two-sample Hotelling T-Squared test and compute Bartlett's test for homogeneous covariance matrices. We must now create separate data sets for Benign and Malignant tumors.
```{r}
cancer.matrix = as.matrix(cancer[,3:32])
fit=manova(cancer.matrix~cancer$diagnosis)
summary(fit, test="Hotelling-Lawley")

library(ICSNP)
cancer1 <- cancer[cancer[,2]=="M",3:32]
cancer2 <- cancer[cancer[,2]=="B",3:32]

HotellingsT2(cancer1,cancer2)

n1 = dim(cancer1)[1]
n2 = dim(cancer2)[1]
source("Box_M.R")
Box_M(cancer.matrix, n=c(n1, n2))
```

